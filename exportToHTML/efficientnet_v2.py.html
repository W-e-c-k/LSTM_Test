<html>
<head>
<title>efficientnet_v2.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cf8e6d;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #6aab73;}
.s4 { color: #7a7e85;}
.s5 { color: #2aacb8;}
.s6 { color: #5f826b; font-style: italic;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
efficientnet_v2.py</font>
</center></td></tr></table>
<pre><span class="s0">import </span><span class="s1">copy</span>
<span class="s0">import </span><span class="s1">math</span>

<span class="s0">from </span><span class="s1">keras</span><span class="s2">.</span><span class="s1">src </span><span class="s0">import </span><span class="s1">backend</span>
<span class="s0">from </span><span class="s1">keras</span><span class="s2">.</span><span class="s1">src </span><span class="s0">import </span><span class="s1">initializers</span>
<span class="s0">from </span><span class="s1">keras</span><span class="s2">.</span><span class="s1">src </span><span class="s0">import </span><span class="s1">layers</span>
<span class="s0">from </span><span class="s1">keras</span><span class="s2">.</span><span class="s1">src</span><span class="s2">.</span><span class="s1">api_export </span><span class="s0">import </span><span class="s1">keras_export</span>
<span class="s0">from </span><span class="s1">keras</span><span class="s2">.</span><span class="s1">src</span><span class="s2">.</span><span class="s1">applications </span><span class="s0">import </span><span class="s1">imagenet_utils</span>
<span class="s0">from </span><span class="s1">keras</span><span class="s2">.</span><span class="s1">src</span><span class="s2">.</span><span class="s1">models </span><span class="s0">import </span><span class="s1">Functional</span>
<span class="s0">from </span><span class="s1">keras</span><span class="s2">.</span><span class="s1">src</span><span class="s2">.</span><span class="s1">ops </span><span class="s0">import </span><span class="s1">operation_utils</span>
<span class="s0">from </span><span class="s1">keras</span><span class="s2">.</span><span class="s1">src</span><span class="s2">.</span><span class="s1">utils </span><span class="s0">import </span><span class="s1">file_utils</span>

<span class="s1">BASE_WEIGHTS_PATH </span><span class="s2">= </span><span class="s3">&quot;https://storage.googleapis.com/tensorflow/keras-applications/efficientnet_v2/&quot;  </span><span class="s4"># noqa: E501</span>

<span class="s1">WEIGHTS_HASHES </span><span class="s2">= {</span>
    <span class="s3">&quot;b0&quot;</span><span class="s2">: (</span>
        <span class="s3">&quot;21ecbf6da12460d5c40bb2f29ceb2188&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;893217f2bb855e2983157299931e43ff&quot;</span><span class="s2">,</span>
    <span class="s2">),</span>
    <span class="s3">&quot;b1&quot;</span><span class="s2">: (</span>
        <span class="s3">&quot;069f0534ff22adf035c89e2d9547a9dc&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;0e80663031ca32d657f9caa404b6ec37&quot;</span><span class="s2">,</span>
    <span class="s2">),</span>
    <span class="s3">&quot;b2&quot;</span><span class="s2">: (</span>
        <span class="s3">&quot;424e49f28180edbde1e94797771950a7&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;1dfe2e7a5d45b6632553a8961ea609eb&quot;</span><span class="s2">,</span>
    <span class="s2">),</span>
    <span class="s3">&quot;b3&quot;</span><span class="s2">: (</span>
        <span class="s3">&quot;1f1fc43bd98a6e4fd8fdfd551e02c7a0&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;f6abf7b5849ac99a89b50dd3fd532856&quot;</span><span class="s2">,</span>
    <span class="s2">),</span>
    <span class="s3">&quot;-s&quot;</span><span class="s2">: (</span>
        <span class="s3">&quot;e1d88a8495beba45748fedd0cecbe016&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;af0682fb74e8c54910f2d4393339c070&quot;</span><span class="s2">,</span>
    <span class="s2">),</span>
    <span class="s3">&quot;-m&quot;</span><span class="s2">: (</span>
        <span class="s3">&quot;a3bf6aa3276309f4fc6a34aa114c95cd&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;1b8dc055df72dde80d614482840fe342&quot;</span><span class="s2">,</span>
    <span class="s2">),</span>
    <span class="s3">&quot;-l&quot;</span><span class="s2">: (</span>
        <span class="s3">&quot;27e6d408b53c7ebc868fefa357689935&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;b0b66b5c863aef5b46e8608fe1711615&quot;</span><span class="s2">,</span>
    <span class="s2">),</span>
<span class="s2">}</span>

<span class="s1">DEFAULT_BLOCKS_ARGS </span><span class="s2">= {</span>
    <span class="s3">&quot;efficientnetv2-s&quot;</span><span class="s2">: [</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">24</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">24</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0.0</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">4</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">24</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">48</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">4</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0.0</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">4</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">48</span><span class="s2">,</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">4</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">64</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">4</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">64</span><span class="s2">,</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">6</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">128</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0.25</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">6</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">128</span><span class="s2">,</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">9</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">160</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0.25</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">6</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">160</span><span class="s2">,</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">15</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">256</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0.25</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
        <span class="s2">},</span>
    <span class="s2">],</span>
    <span class="s3">&quot;efficientnetv2-m&quot;</span><span class="s2">: [</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">24</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">24</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">5</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">24</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">48</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">4</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">5</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">48</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">80</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">4</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">7</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">80</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">160</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">4</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0.25</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">14</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">160</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">176</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">6</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0.25</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">18</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">176</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">304</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">6</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0.25</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">5</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">304</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">512</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">6</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0.25</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
        <span class="s2">},</span>
    <span class="s2">],</span>
    <span class="s3">&quot;efficientnetv2-l&quot;</span><span class="s2">: [</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">4</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">32</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">32</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">7</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">32</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">64</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">4</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">7</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">64</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">96</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">4</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">10</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">96</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">192</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">4</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0.25</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">19</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">192</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">224</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">6</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0.25</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">25</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">224</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">384</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">6</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0.25</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">7</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">384</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">640</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">6</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0.25</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
        <span class="s2">},</span>
    <span class="s2">],</span>
    <span class="s3">&quot;efficientnetv2-b0&quot;</span><span class="s2">: [</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">32</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">16</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">16</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">32</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">4</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">32</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">48</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">4</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">48</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">96</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">4</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0.25</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">5</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">96</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">112</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">6</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0.25</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">8</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">112</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">192</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">6</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0.25</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
        <span class="s2">},</span>
    <span class="s2">],</span>
    <span class="s3">&quot;efficientnetv2-b1&quot;</span><span class="s2">: [</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">32</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">16</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">16</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">32</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">4</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">32</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">48</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">4</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">48</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">96</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">4</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0.25</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">5</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">96</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">112</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">6</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0.25</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">8</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">112</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">192</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">6</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0.25</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
        <span class="s2">},</span>
    <span class="s2">],</span>
    <span class="s3">&quot;efficientnetv2-b2&quot;</span><span class="s2">: [</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">32</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">16</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">16</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">32</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">4</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">32</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">48</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">4</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">48</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">96</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">4</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0.25</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">5</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">96</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">112</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">6</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0.25</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">8</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">112</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">192</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">6</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0.25</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
        <span class="s2">},</span>
    <span class="s2">],</span>
    <span class="s3">&quot;efficientnetv2-b3&quot;</span><span class="s2">: [</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">32</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">16</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">16</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">32</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">4</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">32</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">48</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">4</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">48</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">96</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">4</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0.25</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">5</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">96</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">112</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">6</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0.25</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">1</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
        <span class="s2">},</span>
        <span class="s2">{</span>
            <span class="s3">&quot;kernel_size&quot;</span><span class="s2">: </span><span class="s5">3</span><span class="s2">,</span>
            <span class="s3">&quot;num_repeat&quot;</span><span class="s2">: </span><span class="s5">8</span><span class="s2">,</span>
            <span class="s3">&quot;input_filters&quot;</span><span class="s2">: </span><span class="s5">112</span><span class="s2">,</span>
            <span class="s3">&quot;output_filters&quot;</span><span class="s2">: </span><span class="s5">192</span><span class="s2">,</span>
            <span class="s3">&quot;expand_ratio&quot;</span><span class="s2">: </span><span class="s5">6</span><span class="s2">,</span>
            <span class="s3">&quot;se_ratio&quot;</span><span class="s2">: </span><span class="s5">0.25</span><span class="s2">,</span>
            <span class="s3">&quot;strides&quot;</span><span class="s2">: </span><span class="s5">2</span><span class="s2">,</span>
            <span class="s3">&quot;conv_type&quot;</span><span class="s2">: </span><span class="s5">0</span><span class="s2">,</span>
        <span class="s2">},</span>
    <span class="s2">],</span>
<span class="s2">}</span>

<span class="s1">CONV_KERNEL_INITIALIZER </span><span class="s2">= {</span>
    <span class="s3">&quot;class_name&quot;</span><span class="s2">: </span><span class="s3">&quot;VarianceScaling&quot;</span><span class="s2">,</span>
    <span class="s3">&quot;config&quot;</span><span class="s2">: {</span>
        <span class="s3">&quot;scale&quot;</span><span class="s2">: </span><span class="s5">2.0</span><span class="s2">,</span>
        <span class="s3">&quot;mode&quot;</span><span class="s2">: </span><span class="s3">&quot;fan_out&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;distribution&quot;</span><span class="s2">: </span><span class="s3">&quot;truncated_normal&quot;</span><span class="s2">,</span>
    <span class="s2">},</span>
<span class="s2">}</span>

<span class="s1">DENSE_KERNEL_INITIALIZER </span><span class="s2">= {</span>
    <span class="s3">&quot;class_name&quot;</span><span class="s2">: </span><span class="s3">&quot;VarianceScaling&quot;</span><span class="s2">,</span>
    <span class="s3">&quot;config&quot;</span><span class="s2">: {</span>
        <span class="s3">&quot;scale&quot;</span><span class="s2">: </span><span class="s5">1.0 </span><span class="s2">/ </span><span class="s5">3.0</span><span class="s2">,</span>
        <span class="s3">&quot;mode&quot;</span><span class="s2">: </span><span class="s3">&quot;fan_out&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;distribution&quot;</span><span class="s2">: </span><span class="s3">&quot;uniform&quot;</span><span class="s2">,</span>
    <span class="s2">},</span>
<span class="s2">}</span>

<span class="s1">BASE_DOCSTRING </span><span class="s2">= </span><span class="s3">&quot;&quot;&quot;Instantiates the {name} architecture. 
 
Reference: 
- [EfficientNetV2: Smaller Models and Faster Training]( 
    https://arxiv.org/abs/2104.00298) (ICML 2021) 
 
This function returns a Keras image classification model, 
optionally loaded with weights pre-trained on ImageNet. 
 
For image classification use cases, see 
[this page for detailed examples]( 
https://keras.io/api/applications/#usage-examples-for-image-classification-models). 
 
For transfer learning use cases, make sure to read the 
[guide to transfer learning &amp; fine-tuning]( 
https://keras.io/guides/transfer_learning/). 
 
Note: each Keras Application expects a specific kind of input preprocessing. 
For EfficientNetV2, by default input preprocessing is included as a part of 
the model (as a `Rescaling` layer), and thus 
`keras.applications.efficientnet_v2.preprocess_input` is actually a 
pass-through function. In this use case, EfficientNetV2 models expect their 
inputs to be float tensors of pixels with values in the `[0, 255]` range. 
At the same time, preprocessing as a part of the model (i.e. `Rescaling` 
layer) can be disabled by setting `include_preprocessing` argument to `False`. 
With preprocessing disabled EfficientNetV2 models expect their inputs to be 
float tensors of pixels with values in the `[-1, 1]` range. 
 
Args: 
    include_top: Boolean, whether to include the fully-connected 
        layer at the top of the network. Defaults to `True`. 
    weights: One of `None` (random initialization), 
        `&quot;imagenet&quot;` (pre-training on ImageNet), 
        or the path to the weights file to be loaded. Defaults to `&quot;imagenet&quot;`. 
    input_tensor: Optional Keras tensor 
        (i.e. output of `layers.Input()`) 
        to use as image input for the model. 
    input_shape: Optional shape tuple, only to be specified 
        if `include_top` is `False`. 
        It should have exactly 3 inputs channels. 
    pooling: Optional pooling mode for feature extraction 
        when `include_top` is `False`. Defaults to None. 
        - `None` means that the output of the model will be 
            the 4D tensor output of the 
            last convolutional layer. 
        - `&quot;avg&quot;` means that global average pooling 
            will be applied to the output of the 
            last convolutional layer, and thus 
            the output of the model will be a 2D tensor. 
        - `&quot;max&quot;` means that global max pooling will 
            be applied. 
    classes: Optional number of classes to classify images 
        into, only to be specified if `include_top` is `True`, and 
        if no `weights` argument is specified. Defaults to 1000 (number of 
        ImageNet classes). 
    classifier_activation: A string or callable. The activation function to use 
        on the &quot;top&quot; layer. Ignored unless `include_top=True`. Set 
        `classifier_activation=None` to return the logits of the &quot;top&quot; layer. 
        Defaults to `&quot;softmax&quot;`. 
        When loading pretrained weights, `classifier_activation` can only 
        be `None` or `&quot;softmax&quot;`. 
    name: The name of the model (string). 
 
Returns: 
    A model instance. 
&quot;&quot;&quot;</span>


<span class="s0">def </span><span class="s1">round_filters</span><span class="s2">(</span><span class="s1">filters</span><span class="s2">, </span><span class="s1">width_coefficient</span><span class="s2">, </span><span class="s1">min_depth</span><span class="s2">, </span><span class="s1">depth_divisor</span><span class="s2">):</span>
    <span class="s6">&quot;&quot;&quot;Round number of filters based on depth multiplier.&quot;&quot;&quot;</span>
    <span class="s1">filters </span><span class="s2">*= </span><span class="s1">width_coefficient</span>
    <span class="s1">minimum_depth </span><span class="s2">= </span><span class="s1">min_depth </span><span class="s0">or </span><span class="s1">depth_divisor</span>
    <span class="s1">new_filters </span><span class="s2">= </span><span class="s1">max</span><span class="s2">(</span>
        <span class="s1">minimum_depth</span><span class="s2">,</span>
        <span class="s1">int</span><span class="s2">(</span><span class="s1">filters </span><span class="s2">+ </span><span class="s1">depth_divisor </span><span class="s2">/ </span><span class="s5">2</span><span class="s2">) // </span><span class="s1">depth_divisor </span><span class="s2">* </span><span class="s1">depth_divisor</span><span class="s2">,</span>
    <span class="s2">)</span>
    <span class="s0">return </span><span class="s1">int</span><span class="s2">(</span><span class="s1">new_filters</span><span class="s2">)</span>


<span class="s0">def </span><span class="s1">round_repeats</span><span class="s2">(</span><span class="s1">repeats</span><span class="s2">, </span><span class="s1">depth_coefficient</span><span class="s2">):</span>
    <span class="s6">&quot;&quot;&quot;Round number of repeats based on depth multiplier.&quot;&quot;&quot;</span>
    <span class="s0">return </span><span class="s1">int</span><span class="s2">(</span><span class="s1">math</span><span class="s2">.</span><span class="s1">ceil</span><span class="s2">(</span><span class="s1">depth_coefficient </span><span class="s2">* </span><span class="s1">repeats</span><span class="s2">))</span>


<span class="s0">def </span><span class="s1">MBConvBlock</span><span class="s2">(</span>
    <span class="s1">input_filters</span><span class="s2">,</span>
    <span class="s1">output_filters</span><span class="s2">,</span>
    <span class="s1">expand_ratio</span><span class="s2">=</span><span class="s5">1</span><span class="s2">,</span>
    <span class="s1">kernel_size</span><span class="s2">=</span><span class="s5">3</span><span class="s2">,</span>
    <span class="s1">strides</span><span class="s2">=</span><span class="s5">1</span><span class="s2">,</span>
    <span class="s1">se_ratio</span><span class="s2">=</span><span class="s5">0.0</span><span class="s2">,</span>
    <span class="s1">bn_momentum</span><span class="s2">=</span><span class="s5">0.9</span><span class="s2">,</span>
    <span class="s1">activation</span><span class="s2">=</span><span class="s3">&quot;swish&quot;</span><span class="s2">,</span>
    <span class="s1">survival_probability</span><span class="s2">=</span><span class="s5">0.8</span><span class="s2">,</span>
    <span class="s1">name</span><span class="s2">=</span><span class="s0">None</span><span class="s2">,</span>
<span class="s2">):</span>
    <span class="s6">&quot;&quot;&quot;MBConv block: Mobile Inverted Residual Bottleneck.&quot;&quot;&quot;</span>
    <span class="s1">bn_axis </span><span class="s2">= </span><span class="s5">3 </span><span class="s0">if </span><span class="s1">backend</span><span class="s2">.</span><span class="s1">image_data_format</span><span class="s2">() == </span><span class="s3">&quot;channels_last&quot; </span><span class="s0">else </span><span class="s5">1</span>

    <span class="s0">if </span><span class="s1">name </span><span class="s0">is None</span><span class="s2">:</span>
        <span class="s1">name </span><span class="s2">= </span><span class="s1">backend</span><span class="s2">.</span><span class="s1">get_uid</span><span class="s2">(</span><span class="s3">&quot;block0&quot;</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">apply</span><span class="s2">(</span><span class="s1">inputs</span><span class="s2">):</span>
        <span class="s4"># Expansion phase</span>
        <span class="s1">filters </span><span class="s2">= </span><span class="s1">input_filters </span><span class="s2">* </span><span class="s1">expand_ratio</span>
        <span class="s0">if </span><span class="s1">expand_ratio </span><span class="s2">!= </span><span class="s5">1</span><span class="s2">:</span>
            <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">Conv2D</span><span class="s2">(</span>
                <span class="s1">filters</span><span class="s2">=</span><span class="s1">filters</span><span class="s2">,</span>
                <span class="s1">kernel_size</span><span class="s2">=</span><span class="s5">1</span><span class="s2">,</span>
                <span class="s1">strides</span><span class="s2">=</span><span class="s5">1</span><span class="s2">,</span>
                <span class="s1">kernel_initializer</span><span class="s2">=</span><span class="s1">CONV_KERNEL_INITIALIZER</span><span class="s2">,</span>
                <span class="s1">padding</span><span class="s2">=</span><span class="s3">&quot;same&quot;</span><span class="s2">,</span>
                <span class="s1">data_format</span><span class="s2">=</span><span class="s1">backend</span><span class="s2">.</span><span class="s1">image_data_format</span><span class="s2">(),</span>
                <span class="s1">use_bias</span><span class="s2">=</span><span class="s0">False</span><span class="s2">,</span>
                <span class="s1">name</span><span class="s2">=</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">&quot;expand_conv&quot;</span><span class="s2">,</span>
            <span class="s2">)(</span><span class="s1">inputs</span><span class="s2">)</span>
            <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">BatchNormalization</span><span class="s2">(</span>
                <span class="s1">axis</span><span class="s2">=</span><span class="s1">bn_axis</span><span class="s2">,</span>
                <span class="s1">momentum</span><span class="s2">=</span><span class="s1">bn_momentum</span><span class="s2">,</span>
                <span class="s1">name</span><span class="s2">=</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">&quot;expand_bn&quot;</span><span class="s2">,</span>
            <span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>
            <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">Activation</span><span class="s2">(</span><span class="s1">activation</span><span class="s2">, </span><span class="s1">name</span><span class="s2">=</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">&quot;expand_activation&quot;</span><span class="s2">)(</span>
                <span class="s1">x</span>
            <span class="s2">)</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">x </span><span class="s2">= </span><span class="s1">inputs</span>

        <span class="s4"># Depthwise conv</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">DepthwiseConv2D</span><span class="s2">(</span>
            <span class="s1">kernel_size</span><span class="s2">=</span><span class="s1">kernel_size</span><span class="s2">,</span>
            <span class="s1">strides</span><span class="s2">=</span><span class="s1">strides</span><span class="s2">,</span>
            <span class="s1">depthwise_initializer</span><span class="s2">=</span><span class="s1">CONV_KERNEL_INITIALIZER</span><span class="s2">,</span>
            <span class="s1">padding</span><span class="s2">=</span><span class="s3">&quot;same&quot;</span><span class="s2">,</span>
            <span class="s1">data_format</span><span class="s2">=</span><span class="s1">backend</span><span class="s2">.</span><span class="s1">image_data_format</span><span class="s2">(),</span>
            <span class="s1">use_bias</span><span class="s2">=</span><span class="s0">False</span><span class="s2">,</span>
            <span class="s1">name</span><span class="s2">=</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">&quot;dwconv2&quot;</span><span class="s2">,</span>
        <span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">BatchNormalization</span><span class="s2">(</span>
            <span class="s1">axis</span><span class="s2">=</span><span class="s1">bn_axis</span><span class="s2">, </span><span class="s1">momentum</span><span class="s2">=</span><span class="s1">bn_momentum</span><span class="s2">, </span><span class="s1">name</span><span class="s2">=</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">&quot;bn&quot;</span>
        <span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">Activation</span><span class="s2">(</span><span class="s1">activation</span><span class="s2">, </span><span class="s1">name</span><span class="s2">=</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">&quot;activation&quot;</span><span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>

        <span class="s4"># Squeeze and excite</span>
        <span class="s0">if </span><span class="s5">0 </span><span class="s2">&lt; </span><span class="s1">se_ratio </span><span class="s2">&lt;= </span><span class="s5">1</span><span class="s2">:</span>
            <span class="s1">filters_se </span><span class="s2">= </span><span class="s1">max</span><span class="s2">(</span><span class="s5">1</span><span class="s2">, </span><span class="s1">int</span><span class="s2">(</span><span class="s1">input_filters </span><span class="s2">* </span><span class="s1">se_ratio</span><span class="s2">))</span>
            <span class="s1">se </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">GlobalAveragePooling2D</span><span class="s2">(</span><span class="s1">name</span><span class="s2">=</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">&quot;se_squeeze&quot;</span><span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>
            <span class="s0">if </span><span class="s1">bn_axis </span><span class="s2">== </span><span class="s5">1</span><span class="s2">:</span>
                <span class="s1">se_shape </span><span class="s2">= (</span><span class="s1">filters</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">)</span>
            <span class="s0">else</span><span class="s2">:</span>
                <span class="s1">se_shape </span><span class="s2">= (</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s1">filters</span><span class="s2">)</span>
            <span class="s1">se </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">Reshape</span><span class="s2">(</span><span class="s1">se_shape</span><span class="s2">, </span><span class="s1">name</span><span class="s2">=</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">&quot;se_reshape&quot;</span><span class="s2">)(</span><span class="s1">se</span><span class="s2">)</span>

            <span class="s1">se </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">Conv2D</span><span class="s2">(</span>
                <span class="s1">filters_se</span><span class="s2">,</span>
                <span class="s5">1</span><span class="s2">,</span>
                <span class="s1">padding</span><span class="s2">=</span><span class="s3">&quot;same&quot;</span><span class="s2">,</span>
                <span class="s1">activation</span><span class="s2">=</span><span class="s1">activation</span><span class="s2">,</span>
                <span class="s1">kernel_initializer</span><span class="s2">=</span><span class="s1">CONV_KERNEL_INITIALIZER</span><span class="s2">,</span>
                <span class="s1">name</span><span class="s2">=</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">&quot;se_reduce&quot;</span><span class="s2">,</span>
            <span class="s2">)(</span><span class="s1">se</span><span class="s2">)</span>
            <span class="s1">se </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">Conv2D</span><span class="s2">(</span>
                <span class="s1">filters</span><span class="s2">,</span>
                <span class="s5">1</span><span class="s2">,</span>
                <span class="s1">padding</span><span class="s2">=</span><span class="s3">&quot;same&quot;</span><span class="s2">,</span>
                <span class="s1">activation</span><span class="s2">=</span><span class="s3">&quot;sigmoid&quot;</span><span class="s2">,</span>
                <span class="s1">kernel_initializer</span><span class="s2">=</span><span class="s1">CONV_KERNEL_INITIALIZER</span><span class="s2">,</span>
                <span class="s1">name</span><span class="s2">=</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">&quot;se_expand&quot;</span><span class="s2">,</span>
            <span class="s2">)(</span><span class="s1">se</span><span class="s2">)</span>

            <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">multiply</span><span class="s2">([</span><span class="s1">x</span><span class="s2">, </span><span class="s1">se</span><span class="s2">], </span><span class="s1">name</span><span class="s2">=</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">&quot;se_excite&quot;</span><span class="s2">)</span>

        <span class="s4"># Output phase</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">Conv2D</span><span class="s2">(</span>
            <span class="s1">filters</span><span class="s2">=</span><span class="s1">output_filters</span><span class="s2">,</span>
            <span class="s1">kernel_size</span><span class="s2">=</span><span class="s5">1</span><span class="s2">,</span>
            <span class="s1">strides</span><span class="s2">=</span><span class="s5">1</span><span class="s2">,</span>
            <span class="s1">kernel_initializer</span><span class="s2">=</span><span class="s1">CONV_KERNEL_INITIALIZER</span><span class="s2">,</span>
            <span class="s1">padding</span><span class="s2">=</span><span class="s3">&quot;same&quot;</span><span class="s2">,</span>
            <span class="s1">data_format</span><span class="s2">=</span><span class="s1">backend</span><span class="s2">.</span><span class="s1">image_data_format</span><span class="s2">(),</span>
            <span class="s1">use_bias</span><span class="s2">=</span><span class="s0">False</span><span class="s2">,</span>
            <span class="s1">name</span><span class="s2">=</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">&quot;project_conv&quot;</span><span class="s2">,</span>
        <span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">BatchNormalization</span><span class="s2">(</span>
            <span class="s1">axis</span><span class="s2">=</span><span class="s1">bn_axis</span><span class="s2">, </span><span class="s1">momentum</span><span class="s2">=</span><span class="s1">bn_momentum</span><span class="s2">, </span><span class="s1">name</span><span class="s2">=</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">&quot;project_bn&quot;</span>
        <span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>

        <span class="s0">if </span><span class="s1">strides </span><span class="s2">== </span><span class="s5">1 </span><span class="s0">and </span><span class="s1">input_filters </span><span class="s2">== </span><span class="s1">output_filters</span><span class="s2">:</span>
            <span class="s0">if </span><span class="s1">survival_probability</span><span class="s2">:</span>
                <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">Dropout</span><span class="s2">(</span>
                    <span class="s1">survival_probability</span><span class="s2">,</span>
                    <span class="s1">noise_shape</span><span class="s2">=(</span><span class="s0">None</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">),</span>
                    <span class="s1">name</span><span class="s2">=</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">&quot;drop&quot;</span><span class="s2">,</span>
                <span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>
            <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">add</span><span class="s2">([</span><span class="s1">x</span><span class="s2">, </span><span class="s1">inputs</span><span class="s2">], </span><span class="s1">name</span><span class="s2">=</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">&quot;add&quot;</span><span class="s2">)</span>

        <span class="s0">return </span><span class="s1">x</span>

    <span class="s0">return </span><span class="s1">apply</span>


<span class="s0">def </span><span class="s1">FusedMBConvBlock</span><span class="s2">(</span>
    <span class="s1">input_filters</span><span class="s2">,</span>
    <span class="s1">output_filters</span><span class="s2">,</span>
    <span class="s1">expand_ratio</span><span class="s2">=</span><span class="s5">1</span><span class="s2">,</span>
    <span class="s1">kernel_size</span><span class="s2">=</span><span class="s5">3</span><span class="s2">,</span>
    <span class="s1">strides</span><span class="s2">=</span><span class="s5">1</span><span class="s2">,</span>
    <span class="s1">se_ratio</span><span class="s2">=</span><span class="s5">0.0</span><span class="s2">,</span>
    <span class="s1">bn_momentum</span><span class="s2">=</span><span class="s5">0.9</span><span class="s2">,</span>
    <span class="s1">activation</span><span class="s2">=</span><span class="s3">&quot;swish&quot;</span><span class="s2">,</span>
    <span class="s1">survival_probability</span><span class="s2">=</span><span class="s5">0.8</span><span class="s2">,</span>
    <span class="s1">name</span><span class="s2">=</span><span class="s0">None</span><span class="s2">,</span>
<span class="s2">):</span>
    <span class="s6">&quot;&quot;&quot;Fuses the proj conv1x1 and depthwise_conv into a conv2d.&quot;&quot;&quot;</span>
    <span class="s1">bn_axis </span><span class="s2">= </span><span class="s5">3 </span><span class="s0">if </span><span class="s1">backend</span><span class="s2">.</span><span class="s1">image_data_format</span><span class="s2">() == </span><span class="s3">&quot;channels_last&quot; </span><span class="s0">else </span><span class="s5">1</span>

    <span class="s0">if </span><span class="s1">name </span><span class="s0">is None</span><span class="s2">:</span>
        <span class="s1">name </span><span class="s2">= </span><span class="s1">backend</span><span class="s2">.</span><span class="s1">get_uid</span><span class="s2">(</span><span class="s3">&quot;block0&quot;</span><span class="s2">)</span>

    <span class="s0">def </span><span class="s1">apply</span><span class="s2">(</span><span class="s1">inputs</span><span class="s2">):</span>
        <span class="s1">filters </span><span class="s2">= </span><span class="s1">input_filters </span><span class="s2">* </span><span class="s1">expand_ratio</span>
        <span class="s0">if </span><span class="s1">expand_ratio </span><span class="s2">!= </span><span class="s5">1</span><span class="s2">:</span>
            <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">Conv2D</span><span class="s2">(</span>
                <span class="s1">filters</span><span class="s2">,</span>
                <span class="s1">kernel_size</span><span class="s2">=</span><span class="s1">kernel_size</span><span class="s2">,</span>
                <span class="s1">strides</span><span class="s2">=</span><span class="s1">strides</span><span class="s2">,</span>
                <span class="s1">kernel_initializer</span><span class="s2">=</span><span class="s1">CONV_KERNEL_INITIALIZER</span><span class="s2">,</span>
                <span class="s1">data_format</span><span class="s2">=</span><span class="s1">backend</span><span class="s2">.</span><span class="s1">image_data_format</span><span class="s2">(),</span>
                <span class="s1">padding</span><span class="s2">=</span><span class="s3">&quot;same&quot;</span><span class="s2">,</span>
                <span class="s1">use_bias</span><span class="s2">=</span><span class="s0">False</span><span class="s2">,</span>
                <span class="s1">name</span><span class="s2">=</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">&quot;expand_conv&quot;</span><span class="s2">,</span>
            <span class="s2">)(</span><span class="s1">inputs</span><span class="s2">)</span>
            <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">BatchNormalization</span><span class="s2">(</span>
                <span class="s1">axis</span><span class="s2">=</span><span class="s1">bn_axis</span><span class="s2">, </span><span class="s1">momentum</span><span class="s2">=</span><span class="s1">bn_momentum</span><span class="s2">, </span><span class="s1">name</span><span class="s2">=</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">&quot;expand_bn&quot;</span>
            <span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>
            <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">Activation</span><span class="s2">(</span>
                <span class="s1">activation</span><span class="s2">=</span><span class="s1">activation</span><span class="s2">, </span><span class="s1">name</span><span class="s2">=</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">&quot;expand_activation&quot;</span>
            <span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">x </span><span class="s2">= </span><span class="s1">inputs</span>

        <span class="s4"># Squeeze and excite</span>
        <span class="s0">if </span><span class="s5">0 </span><span class="s2">&lt; </span><span class="s1">se_ratio </span><span class="s2">&lt;= </span><span class="s5">1</span><span class="s2">:</span>
            <span class="s1">filters_se </span><span class="s2">= </span><span class="s1">max</span><span class="s2">(</span><span class="s5">1</span><span class="s2">, </span><span class="s1">int</span><span class="s2">(</span><span class="s1">input_filters </span><span class="s2">* </span><span class="s1">se_ratio</span><span class="s2">))</span>
            <span class="s1">se </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">GlobalAveragePooling2D</span><span class="s2">(</span><span class="s1">name</span><span class="s2">=</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">&quot;se_squeeze&quot;</span><span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>
            <span class="s0">if </span><span class="s1">bn_axis </span><span class="s2">== </span><span class="s5">1</span><span class="s2">:</span>
                <span class="s1">se_shape </span><span class="s2">= (</span><span class="s1">filters</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">)</span>
            <span class="s0">else</span><span class="s2">:</span>
                <span class="s1">se_shape </span><span class="s2">= (</span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s1">filters</span><span class="s2">)</span>

            <span class="s1">se </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">Reshape</span><span class="s2">(</span><span class="s1">se_shape</span><span class="s2">, </span><span class="s1">name</span><span class="s2">=</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">&quot;se_reshape&quot;</span><span class="s2">)(</span><span class="s1">se</span><span class="s2">)</span>

            <span class="s1">se </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">Conv2D</span><span class="s2">(</span>
                <span class="s1">filters_se</span><span class="s2">,</span>
                <span class="s5">1</span><span class="s2">,</span>
                <span class="s1">padding</span><span class="s2">=</span><span class="s3">&quot;same&quot;</span><span class="s2">,</span>
                <span class="s1">activation</span><span class="s2">=</span><span class="s1">activation</span><span class="s2">,</span>
                <span class="s1">kernel_initializer</span><span class="s2">=</span><span class="s1">CONV_KERNEL_INITIALIZER</span><span class="s2">,</span>
                <span class="s1">name</span><span class="s2">=</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">&quot;se_reduce&quot;</span><span class="s2">,</span>
            <span class="s2">)(</span><span class="s1">se</span><span class="s2">)</span>
            <span class="s1">se </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">Conv2D</span><span class="s2">(</span>
                <span class="s1">filters</span><span class="s2">,</span>
                <span class="s5">1</span><span class="s2">,</span>
                <span class="s1">padding</span><span class="s2">=</span><span class="s3">&quot;same&quot;</span><span class="s2">,</span>
                <span class="s1">activation</span><span class="s2">=</span><span class="s3">&quot;sigmoid&quot;</span><span class="s2">,</span>
                <span class="s1">kernel_initializer</span><span class="s2">=</span><span class="s1">CONV_KERNEL_INITIALIZER</span><span class="s2">,</span>
                <span class="s1">name</span><span class="s2">=</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">&quot;se_expand&quot;</span><span class="s2">,</span>
            <span class="s2">)(</span><span class="s1">se</span><span class="s2">)</span>

            <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">multiply</span><span class="s2">([</span><span class="s1">x</span><span class="s2">, </span><span class="s1">se</span><span class="s2">], </span><span class="s1">name</span><span class="s2">=</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">&quot;se_excite&quot;</span><span class="s2">)</span>

        <span class="s4"># Output phase:</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">Conv2D</span><span class="s2">(</span>
            <span class="s1">output_filters</span><span class="s2">,</span>
            <span class="s1">kernel_size</span><span class="s2">=</span><span class="s5">1 </span><span class="s0">if </span><span class="s1">expand_ratio </span><span class="s2">!= </span><span class="s5">1 </span><span class="s0">else </span><span class="s1">kernel_size</span><span class="s2">,</span>
            <span class="s1">strides</span><span class="s2">=</span><span class="s5">1 </span><span class="s0">if </span><span class="s1">expand_ratio </span><span class="s2">!= </span><span class="s5">1 </span><span class="s0">else </span><span class="s1">strides</span><span class="s2">,</span>
            <span class="s1">kernel_initializer</span><span class="s2">=</span><span class="s1">CONV_KERNEL_INITIALIZER</span><span class="s2">,</span>
            <span class="s1">padding</span><span class="s2">=</span><span class="s3">&quot;same&quot;</span><span class="s2">,</span>
            <span class="s1">use_bias</span><span class="s2">=</span><span class="s0">False</span><span class="s2">,</span>
            <span class="s1">name</span><span class="s2">=</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">&quot;project_conv&quot;</span><span class="s2">,</span>
        <span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">BatchNormalization</span><span class="s2">(</span>
            <span class="s1">axis</span><span class="s2">=</span><span class="s1">bn_axis</span><span class="s2">, </span><span class="s1">momentum</span><span class="s2">=</span><span class="s1">bn_momentum</span><span class="s2">, </span><span class="s1">name</span><span class="s2">=</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">&quot;project_bn&quot;</span>
        <span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>
        <span class="s0">if </span><span class="s1">expand_ratio </span><span class="s2">== </span><span class="s5">1</span><span class="s2">:</span>
            <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">Activation</span><span class="s2">(</span>
                <span class="s1">activation</span><span class="s2">=</span><span class="s1">activation</span><span class="s2">, </span><span class="s1">name</span><span class="s2">=</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">&quot;project_activation&quot;</span>
            <span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>

        <span class="s4"># Residual:</span>
        <span class="s0">if </span><span class="s1">strides </span><span class="s2">== </span><span class="s5">1 </span><span class="s0">and </span><span class="s1">input_filters </span><span class="s2">== </span><span class="s1">output_filters</span><span class="s2">:</span>
            <span class="s0">if </span><span class="s1">survival_probability</span><span class="s2">:</span>
                <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">Dropout</span><span class="s2">(</span>
                    <span class="s1">survival_probability</span><span class="s2">,</span>
                    <span class="s1">noise_shape</span><span class="s2">=(</span><span class="s0">None</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">, </span><span class="s5">1</span><span class="s2">),</span>
                    <span class="s1">name</span><span class="s2">=</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">&quot;drop&quot;</span><span class="s2">,</span>
                <span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>
            <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">add</span><span class="s2">([</span><span class="s1">x</span><span class="s2">, </span><span class="s1">inputs</span><span class="s2">], </span><span class="s1">name</span><span class="s2">=</span><span class="s1">name </span><span class="s2">+ </span><span class="s3">&quot;add&quot;</span><span class="s2">)</span>
        <span class="s0">return </span><span class="s1">x</span>

    <span class="s0">return </span><span class="s1">apply</span>


<span class="s0">def </span><span class="s1">EfficientNetV2</span><span class="s2">(</span>
    <span class="s1">width_coefficient</span><span class="s2">,</span>
    <span class="s1">depth_coefficient</span><span class="s2">,</span>
    <span class="s1">default_size</span><span class="s2">,</span>
    <span class="s1">dropout_rate</span><span class="s2">=</span><span class="s5">0.2</span><span class="s2">,</span>
    <span class="s1">drop_connect_rate</span><span class="s2">=</span><span class="s5">0.2</span><span class="s2">,</span>
    <span class="s1">depth_divisor</span><span class="s2">=</span><span class="s5">8</span><span class="s2">,</span>
    <span class="s1">min_depth</span><span class="s2">=</span><span class="s5">8</span><span class="s2">,</span>
    <span class="s1">bn_momentum</span><span class="s2">=</span><span class="s5">0.9</span><span class="s2">,</span>
    <span class="s1">activation</span><span class="s2">=</span><span class="s3">&quot;swish&quot;</span><span class="s2">,</span>
    <span class="s1">blocks_args</span><span class="s2">=</span><span class="s3">&quot;default&quot;</span><span class="s2">,</span>
    <span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;efficientnetv2&quot;</span><span class="s2">,</span>
    <span class="s1">include_top</span><span class="s2">=</span><span class="s0">True</span><span class="s2">,</span>
    <span class="s1">weights</span><span class="s2">=</span><span class="s3">&quot;imagenet&quot;</span><span class="s2">,</span>
    <span class="s1">input_tensor</span><span class="s2">=</span><span class="s0">None</span><span class="s2">,</span>
    <span class="s1">input_shape</span><span class="s2">=</span><span class="s0">None</span><span class="s2">,</span>
    <span class="s1">pooling</span><span class="s2">=</span><span class="s0">None</span><span class="s2">,</span>
    <span class="s1">classes</span><span class="s2">=</span><span class="s5">1000</span><span class="s2">,</span>
    <span class="s1">classifier_activation</span><span class="s2">=</span><span class="s3">&quot;softmax&quot;</span><span class="s2">,</span>
    <span class="s1">include_preprocessing</span><span class="s2">=</span><span class="s0">True</span><span class="s2">,</span>
    <span class="s1">weights_name</span><span class="s2">=</span><span class="s0">None</span><span class="s2">,</span>
<span class="s2">):</span>
    <span class="s6">&quot;&quot;&quot;Instantiates the EfficientNetV2 architecture using given scaling 
    coefficients. 
 
    Args: 
        width_coefficient: float, scaling coefficient for network width. 
        depth_coefficient: float, scaling coefficient for network depth. 
        default_size: integer, default input image size. 
        dropout_rate: float, dropout rate before final classifier layer. 
        drop_connect_rate: float, dropout rate at skip connections. 
        depth_divisor: integer, a unit of network width. 
        min_depth: integer, minimum number of filters. 
        bn_momentum: float. Momentum parameter for Batch Normalization layers. 
        activation: activation function. 
        blocks_args: list of dicts, parameters to construct block modules. 
        name: string, model name. 
        include_top: whether to include the fully-connected layer at the top of 
            the network. 
        weights: one of `None` (random initialization), `&quot;imagenet&quot;` 
            (pre-training on ImageNet), 
            or the path to the weights file to be loaded. 
        input_tensor: optional Keras tensor (i.e. output of `layers.Input()`) or 
            numpy array to use as image input for the model. 
        input_shape: optional shape tuple, only to be specified if `include_top` 
            is `False`. It should have exactly 3 inputs channels. 
        pooling: optional pooling mode for feature extraction when `include_top` 
            is `False`. 
            - `None` means that the output of the model will be the 
                4D tensor output of the last convolutional layer. 
            - &quot;avg&quot; means that global average pooling will be applied to 
                the output of the last convolutional layer, 
                and thus the output of the model will be a 2D tensor. 
            - `&quot;max&quot;` means that global max pooling will be applied. 
        classes: optional number of classes to classify images into, 
            only to be specified if `include_top` is `True`, and if no `weights` 
            argument is specified. 
        classifier_activation: A string or callable. The activation function to 
            use on the &quot;top&quot; layer. Ignored unless `include_top=True`. Set 
            `classifier_activation=None` to return the logits of the &quot;top&quot; 
            layer. 
        include_preprocessing: Boolean, whether to include the preprocessing 
            layer (`Rescaling`) at the bottom of the network. 
            Defaults to `True`. 
 
    Returns: 
        A model instance. 
    &quot;&quot;&quot;</span>

    <span class="s0">if </span><span class="s1">blocks_args </span><span class="s2">== </span><span class="s3">&quot;default&quot;</span><span class="s2">:</span>
        <span class="s1">blocks_args </span><span class="s2">= </span><span class="s1">DEFAULT_BLOCKS_ARGS</span><span class="s2">[</span><span class="s1">name</span><span class="s2">]</span>

    <span class="s0">if not </span><span class="s2">(</span><span class="s1">weights </span><span class="s0">in </span><span class="s2">{</span><span class="s3">&quot;imagenet&quot;</span><span class="s2">, </span><span class="s0">None</span><span class="s2">} </span><span class="s0">or </span><span class="s1">file_utils</span><span class="s2">.</span><span class="s1">exists</span><span class="s2">(</span><span class="s1">weights</span><span class="s2">)):</span>
        <span class="s0">raise </span><span class="s1">ValueError</span><span class="s2">(</span>
            <span class="s3">&quot;The `weights` argument should be either &quot;</span>
            <span class="s3">&quot;`None` (random initialization), `imagenet` &quot;</span>
            <span class="s3">&quot;(pre-training on ImageNet), &quot;</span>
            <span class="s3">&quot;or the path to the weights file to be loaded.&quot;</span>
            <span class="s3">f&quot;Received: weights=</span><span class="s0">{</span><span class="s1">weights</span><span class="s0">}</span><span class="s3">&quot;</span>
        <span class="s2">)</span>

    <span class="s0">if </span><span class="s1">weights </span><span class="s2">== </span><span class="s3">&quot;imagenet&quot; </span><span class="s0">and </span><span class="s1">include_top </span><span class="s0">and </span><span class="s1">classes </span><span class="s2">!= </span><span class="s5">1000</span><span class="s2">:</span>
        <span class="s0">raise </span><span class="s1">ValueError</span><span class="s2">(</span>
            <span class="s3">'If using `weights=&quot;imagenet&quot;` with `include_top`'</span>
            <span class="s3">&quot; as true, `classes` should be 1000&quot;</span>
        <span class="s2">)</span>

    <span class="s4"># Determine proper input shape</span>
    <span class="s1">input_shape </span><span class="s2">= </span><span class="s1">imagenet_utils</span><span class="s2">.</span><span class="s1">obtain_input_shape</span><span class="s2">(</span>
        <span class="s1">input_shape</span><span class="s2">,</span>
        <span class="s1">default_size</span><span class="s2">=</span><span class="s1">default_size</span><span class="s2">,</span>
        <span class="s1">min_size</span><span class="s2">=</span><span class="s5">32</span><span class="s2">,</span>
        <span class="s1">data_format</span><span class="s2">=</span><span class="s1">backend</span><span class="s2">.</span><span class="s1">image_data_format</span><span class="s2">(),</span>
        <span class="s1">require_flatten</span><span class="s2">=</span><span class="s1">include_top</span><span class="s2">,</span>
        <span class="s1">weights</span><span class="s2">=</span><span class="s1">weights</span><span class="s2">,</span>
    <span class="s2">)</span>

    <span class="s0">if </span><span class="s1">input_tensor </span><span class="s0">is None</span><span class="s2">:</span>
        <span class="s1">img_input </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">Input</span><span class="s2">(</span><span class="s1">shape</span><span class="s2">=</span><span class="s1">input_shape</span><span class="s2">)</span>
    <span class="s0">else</span><span class="s2">:</span>
        <span class="s0">if not </span><span class="s1">backend</span><span class="s2">.</span><span class="s1">is_keras_tensor</span><span class="s2">(</span><span class="s1">input_tensor</span><span class="s2">):</span>
            <span class="s1">img_input </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">Input</span><span class="s2">(</span><span class="s1">tensor</span><span class="s2">=</span><span class="s1">input_tensor</span><span class="s2">, </span><span class="s1">shape</span><span class="s2">=</span><span class="s1">input_shape</span><span class="s2">)</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">img_input </span><span class="s2">= </span><span class="s1">input_tensor</span>

    <span class="s1">bn_axis </span><span class="s2">= </span><span class="s5">3 </span><span class="s0">if </span><span class="s1">backend</span><span class="s2">.</span><span class="s1">image_data_format</span><span class="s2">() == </span><span class="s3">&quot;channels_last&quot; </span><span class="s0">else </span><span class="s5">1</span>

    <span class="s1">x </span><span class="s2">= </span><span class="s1">img_input</span>

    <span class="s0">if </span><span class="s1">include_preprocessing</span><span class="s2">:</span>
        <span class="s4"># Apply original V1 preprocessing for Bx variants</span>
        <span class="s4"># if number of channels allows it</span>
        <span class="s1">num_channels </span><span class="s2">= </span><span class="s1">input_shape</span><span class="s2">[</span><span class="s1">bn_axis </span><span class="s2">- </span><span class="s5">1</span><span class="s2">]</span>
        <span class="s0">if </span><span class="s1">name</span><span class="s2">.</span><span class="s1">split</span><span class="s2">(</span><span class="s3">&quot;-&quot;</span><span class="s2">)[-</span><span class="s5">1</span><span class="s2">].</span><span class="s1">startswith</span><span class="s2">(</span><span class="s3">&quot;b&quot;</span><span class="s2">) </span><span class="s0">and </span><span class="s1">num_channels </span><span class="s2">== </span><span class="s5">3</span><span class="s2">:</span>
            <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">Rescaling</span><span class="s2">(</span><span class="s1">scale</span><span class="s2">=</span><span class="s5">1.0 </span><span class="s2">/ </span><span class="s5">255</span><span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>
            <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">Normalization</span><span class="s2">(</span>
                <span class="s1">mean</span><span class="s2">=[</span><span class="s5">0.485</span><span class="s2">, </span><span class="s5">0.456</span><span class="s2">, </span><span class="s5">0.406</span><span class="s2">],</span>
                <span class="s1">variance</span><span class="s2">=[</span><span class="s5">0.229</span><span class="s2">**</span><span class="s5">2</span><span class="s2">, </span><span class="s5">0.224</span><span class="s2">**</span><span class="s5">2</span><span class="s2">, </span><span class="s5">0.225</span><span class="s2">**</span><span class="s5">2</span><span class="s2">],</span>
                <span class="s1">axis</span><span class="s2">=</span><span class="s1">bn_axis</span><span class="s2">,</span>
            <span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">Rescaling</span><span class="s2">(</span><span class="s1">scale</span><span class="s2">=</span><span class="s5">1.0 </span><span class="s2">/ </span><span class="s5">128.0</span><span class="s2">, </span><span class="s1">offset</span><span class="s2">=-</span><span class="s5">1</span><span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>

    <span class="s4"># Build stem</span>
    <span class="s1">stem_filters </span><span class="s2">= </span><span class="s1">round_filters</span><span class="s2">(</span>
        <span class="s1">filters</span><span class="s2">=</span><span class="s1">blocks_args</span><span class="s2">[</span><span class="s5">0</span><span class="s2">][</span><span class="s3">&quot;input_filters&quot;</span><span class="s2">],</span>
        <span class="s1">width_coefficient</span><span class="s2">=</span><span class="s1">width_coefficient</span><span class="s2">,</span>
        <span class="s1">min_depth</span><span class="s2">=</span><span class="s1">min_depth</span><span class="s2">,</span>
        <span class="s1">depth_divisor</span><span class="s2">=</span><span class="s1">depth_divisor</span><span class="s2">,</span>
    <span class="s2">)</span>
    <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">Conv2D</span><span class="s2">(</span>
        <span class="s1">filters</span><span class="s2">=</span><span class="s1">stem_filters</span><span class="s2">,</span>
        <span class="s1">kernel_size</span><span class="s2">=</span><span class="s5">3</span><span class="s2">,</span>
        <span class="s1">strides</span><span class="s2">=</span><span class="s5">2</span><span class="s2">,</span>
        <span class="s1">kernel_initializer</span><span class="s2">=</span><span class="s1">CONV_KERNEL_INITIALIZER</span><span class="s2">,</span>
        <span class="s1">padding</span><span class="s2">=</span><span class="s3">&quot;same&quot;</span><span class="s2">,</span>
        <span class="s1">use_bias</span><span class="s2">=</span><span class="s0">False</span><span class="s2">,</span>
        <span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;stem_conv&quot;</span><span class="s2">,</span>
    <span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>
    <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">BatchNormalization</span><span class="s2">(</span>
        <span class="s1">axis</span><span class="s2">=</span><span class="s1">bn_axis</span><span class="s2">,</span>
        <span class="s1">momentum</span><span class="s2">=</span><span class="s1">bn_momentum</span><span class="s2">,</span>
        <span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;stem_bn&quot;</span><span class="s2">,</span>
    <span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>
    <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">Activation</span><span class="s2">(</span><span class="s1">activation</span><span class="s2">, </span><span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;stem_activation&quot;</span><span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>

    <span class="s4"># Build blocks</span>
    <span class="s1">blocks_args </span><span class="s2">= </span><span class="s1">copy</span><span class="s2">.</span><span class="s1">deepcopy</span><span class="s2">(</span><span class="s1">blocks_args</span><span class="s2">)</span>
    <span class="s1">b </span><span class="s2">= </span><span class="s5">0</span>
    <span class="s1">blocks </span><span class="s2">= </span><span class="s1">float</span><span class="s2">(</span><span class="s1">sum</span><span class="s2">(</span><span class="s1">args</span><span class="s2">[</span><span class="s3">&quot;num_repeat&quot;</span><span class="s2">] </span><span class="s0">for </span><span class="s1">args </span><span class="s0">in </span><span class="s1">blocks_args</span><span class="s2">))</span>

    <span class="s0">for </span><span class="s1">i</span><span class="s2">, </span><span class="s1">args </span><span class="s0">in </span><span class="s1">enumerate</span><span class="s2">(</span><span class="s1">blocks_args</span><span class="s2">):</span>
        <span class="s0">assert </span><span class="s1">args</span><span class="s2">[</span><span class="s3">&quot;num_repeat&quot;</span><span class="s2">] &gt; </span><span class="s5">0</span>

        <span class="s4"># Update block input and output filters based on depth multiplier.</span>
        <span class="s1">args</span><span class="s2">[</span><span class="s3">&quot;input_filters&quot;</span><span class="s2">] = </span><span class="s1">round_filters</span><span class="s2">(</span>
            <span class="s1">filters</span><span class="s2">=</span><span class="s1">args</span><span class="s2">[</span><span class="s3">&quot;input_filters&quot;</span><span class="s2">],</span>
            <span class="s1">width_coefficient</span><span class="s2">=</span><span class="s1">width_coefficient</span><span class="s2">,</span>
            <span class="s1">min_depth</span><span class="s2">=</span><span class="s1">min_depth</span><span class="s2">,</span>
            <span class="s1">depth_divisor</span><span class="s2">=</span><span class="s1">depth_divisor</span><span class="s2">,</span>
        <span class="s2">)</span>
        <span class="s1">args</span><span class="s2">[</span><span class="s3">&quot;output_filters&quot;</span><span class="s2">] = </span><span class="s1">round_filters</span><span class="s2">(</span>
            <span class="s1">filters</span><span class="s2">=</span><span class="s1">args</span><span class="s2">[</span><span class="s3">&quot;output_filters&quot;</span><span class="s2">],</span>
            <span class="s1">width_coefficient</span><span class="s2">=</span><span class="s1">width_coefficient</span><span class="s2">,</span>
            <span class="s1">min_depth</span><span class="s2">=</span><span class="s1">min_depth</span><span class="s2">,</span>
            <span class="s1">depth_divisor</span><span class="s2">=</span><span class="s1">depth_divisor</span><span class="s2">,</span>
        <span class="s2">)</span>

        <span class="s4"># Determine which conv type to use:</span>
        <span class="s1">block </span><span class="s2">= {</span><span class="s5">0</span><span class="s2">: </span><span class="s1">MBConvBlock</span><span class="s2">, </span><span class="s5">1</span><span class="s2">: </span><span class="s1">FusedMBConvBlock</span><span class="s2">}[</span><span class="s1">args</span><span class="s2">.</span><span class="s1">pop</span><span class="s2">(</span><span class="s3">&quot;conv_type&quot;</span><span class="s2">)]</span>
        <span class="s1">repeats </span><span class="s2">= </span><span class="s1">round_repeats</span><span class="s2">(</span>
            <span class="s1">repeats</span><span class="s2">=</span><span class="s1">args</span><span class="s2">.</span><span class="s1">pop</span><span class="s2">(</span><span class="s3">&quot;num_repeat&quot;</span><span class="s2">), </span><span class="s1">depth_coefficient</span><span class="s2">=</span><span class="s1">depth_coefficient</span>
        <span class="s2">)</span>
        <span class="s0">for </span><span class="s1">j </span><span class="s0">in </span><span class="s1">range</span><span class="s2">(</span><span class="s1">repeats</span><span class="s2">):</span>
            <span class="s4"># The first block needs to take care of stride and filter size</span>
            <span class="s4"># increase.</span>
            <span class="s0">if </span><span class="s1">j </span><span class="s2">&gt; </span><span class="s5">0</span><span class="s2">:</span>
                <span class="s1">args</span><span class="s2">[</span><span class="s3">&quot;strides&quot;</span><span class="s2">] = </span><span class="s5">1</span>
                <span class="s1">args</span><span class="s2">[</span><span class="s3">&quot;input_filters&quot;</span><span class="s2">] = </span><span class="s1">args</span><span class="s2">[</span><span class="s3">&quot;output_filters&quot;</span><span class="s2">]</span>

            <span class="s1">x </span><span class="s2">= </span><span class="s1">block</span><span class="s2">(</span>
                <span class="s1">activation</span><span class="s2">=</span><span class="s1">activation</span><span class="s2">,</span>
                <span class="s1">bn_momentum</span><span class="s2">=</span><span class="s1">bn_momentum</span><span class="s2">,</span>
                <span class="s1">survival_probability</span><span class="s2">=</span><span class="s1">drop_connect_rate </span><span class="s2">* </span><span class="s1">b </span><span class="s2">/ </span><span class="s1">blocks</span><span class="s2">,</span>
                <span class="s1">name</span><span class="s2">=</span><span class="s3">f&quot;block</span><span class="s0">{</span><span class="s1">i </span><span class="s2">+ </span><span class="s5">1</span><span class="s0">}{</span><span class="s1">chr</span><span class="s2">(</span><span class="s1">j </span><span class="s2">+ </span><span class="s5">97</span><span class="s2">)</span><span class="s0">}</span><span class="s3">_&quot;</span><span class="s2">,</span>
                <span class="s2">**</span><span class="s1">args</span><span class="s2">,</span>
            <span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>
            <span class="s1">b </span><span class="s2">+= </span><span class="s5">1</span>

    <span class="s4"># Build top</span>
    <span class="s1">top_filters </span><span class="s2">= </span><span class="s1">round_filters</span><span class="s2">(</span>
        <span class="s1">filters</span><span class="s2">=</span><span class="s5">1280</span><span class="s2">,</span>
        <span class="s1">width_coefficient</span><span class="s2">=</span><span class="s1">width_coefficient</span><span class="s2">,</span>
        <span class="s1">min_depth</span><span class="s2">=</span><span class="s1">min_depth</span><span class="s2">,</span>
        <span class="s1">depth_divisor</span><span class="s2">=</span><span class="s1">depth_divisor</span><span class="s2">,</span>
    <span class="s2">)</span>
    <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">Conv2D</span><span class="s2">(</span>
        <span class="s1">filters</span><span class="s2">=</span><span class="s1">top_filters</span><span class="s2">,</span>
        <span class="s1">kernel_size</span><span class="s2">=</span><span class="s5">1</span><span class="s2">,</span>
        <span class="s1">strides</span><span class="s2">=</span><span class="s5">1</span><span class="s2">,</span>
        <span class="s1">kernel_initializer</span><span class="s2">=</span><span class="s1">CONV_KERNEL_INITIALIZER</span><span class="s2">,</span>
        <span class="s1">padding</span><span class="s2">=</span><span class="s3">&quot;same&quot;</span><span class="s2">,</span>
        <span class="s1">data_format</span><span class="s2">=</span><span class="s1">backend</span><span class="s2">.</span><span class="s1">image_data_format</span><span class="s2">(),</span>
        <span class="s1">use_bias</span><span class="s2">=</span><span class="s0">False</span><span class="s2">,</span>
        <span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;top_conv&quot;</span><span class="s2">,</span>
    <span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>
    <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">BatchNormalization</span><span class="s2">(</span>
        <span class="s1">axis</span><span class="s2">=</span><span class="s1">bn_axis</span><span class="s2">,</span>
        <span class="s1">momentum</span><span class="s2">=</span><span class="s1">bn_momentum</span><span class="s2">,</span>
        <span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;top_bn&quot;</span><span class="s2">,</span>
    <span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>
    <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">Activation</span><span class="s2">(</span><span class="s1">activation</span><span class="s2">=</span><span class="s1">activation</span><span class="s2">, </span><span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;top_activation&quot;</span><span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>

    <span class="s0">if </span><span class="s1">include_top</span><span class="s2">:</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">GlobalAveragePooling2D</span><span class="s2">(</span><span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;avg_pool&quot;</span><span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>
        <span class="s0">if </span><span class="s1">dropout_rate </span><span class="s2">&gt; </span><span class="s5">0</span><span class="s2">:</span>
            <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">Dropout</span><span class="s2">(</span><span class="s1">dropout_rate</span><span class="s2">, </span><span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;top_dropout&quot;</span><span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>
        <span class="s1">imagenet_utils</span><span class="s2">.</span><span class="s1">validate_activation</span><span class="s2">(</span><span class="s1">classifier_activation</span><span class="s2">, </span><span class="s1">weights</span><span class="s2">)</span>
        <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">Dense</span><span class="s2">(</span>
            <span class="s1">classes</span><span class="s2">,</span>
            <span class="s1">activation</span><span class="s2">=</span><span class="s1">classifier_activation</span><span class="s2">,</span>
            <span class="s1">kernel_initializer</span><span class="s2">=</span><span class="s1">DENSE_KERNEL_INITIALIZER</span><span class="s2">,</span>
            <span class="s1">bias_initializer</span><span class="s2">=</span><span class="s1">initializers</span><span class="s2">.</span><span class="s1">Constant</span><span class="s2">(</span><span class="s5">0.0</span><span class="s2">),</span>
            <span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;predictions&quot;</span><span class="s2">,</span>
        <span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>
    <span class="s0">else</span><span class="s2">:</span>
        <span class="s0">if </span><span class="s1">pooling </span><span class="s2">== </span><span class="s3">&quot;avg&quot;</span><span class="s2">:</span>
            <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">GlobalAveragePooling2D</span><span class="s2">(</span><span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;avg_pool&quot;</span><span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>
        <span class="s0">elif </span><span class="s1">pooling </span><span class="s2">== </span><span class="s3">&quot;max&quot;</span><span class="s2">:</span>
            <span class="s1">x </span><span class="s2">= </span><span class="s1">layers</span><span class="s2">.</span><span class="s1">GlobalMaxPooling2D</span><span class="s2">(</span><span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;max_pool&quot;</span><span class="s2">)(</span><span class="s1">x</span><span class="s2">)</span>

    <span class="s4"># Ensure that the model takes into account</span>
    <span class="s4"># any potential predecessors of `input_tensor`.</span>
    <span class="s0">if </span><span class="s1">input_tensor </span><span class="s0">is not None</span><span class="s2">:</span>
        <span class="s1">inputs </span><span class="s2">= </span><span class="s1">operation_utils</span><span class="s2">.</span><span class="s1">get_source_inputs</span><span class="s2">(</span><span class="s1">input_tensor</span><span class="s2">)</span>
    <span class="s0">else</span><span class="s2">:</span>
        <span class="s1">inputs </span><span class="s2">= </span><span class="s1">img_input</span>

    <span class="s4"># Create model.</span>
    <span class="s1">model </span><span class="s2">= </span><span class="s1">Functional</span><span class="s2">(</span><span class="s1">inputs</span><span class="s2">, </span><span class="s1">x</span><span class="s2">, </span><span class="s1">name</span><span class="s2">=</span><span class="s1">name</span><span class="s2">)</span>

    <span class="s4"># Load weights.</span>
    <span class="s0">if </span><span class="s1">weights </span><span class="s2">== </span><span class="s3">&quot;imagenet&quot;</span><span class="s2">:</span>
        <span class="s0">if </span><span class="s1">include_top</span><span class="s2">:</span>
            <span class="s1">file_suffix </span><span class="s2">= </span><span class="s3">&quot;.h5&quot;</span>
            <span class="s1">file_hash </span><span class="s2">= </span><span class="s1">WEIGHTS_HASHES</span><span class="s2">[</span><span class="s1">weights_name</span><span class="s2">][</span><span class="s5">0</span><span class="s2">]</span>
        <span class="s0">else</span><span class="s2">:</span>
            <span class="s1">file_suffix </span><span class="s2">= </span><span class="s3">&quot;_notop.h5&quot;</span>
            <span class="s1">file_hash </span><span class="s2">= </span><span class="s1">WEIGHTS_HASHES</span><span class="s2">[</span><span class="s1">weights_name</span><span class="s2">][</span><span class="s5">1</span><span class="s2">]</span>
        <span class="s1">file_name </span><span class="s2">= </span><span class="s1">name </span><span class="s2">+ </span><span class="s1">file_suffix</span>
        <span class="s1">weights_path </span><span class="s2">= </span><span class="s1">file_utils</span><span class="s2">.</span><span class="s1">get_file</span><span class="s2">(</span>
            <span class="s1">file_name</span><span class="s2">,</span>
            <span class="s1">BASE_WEIGHTS_PATH </span><span class="s2">+ </span><span class="s1">file_name</span><span class="s2">,</span>
            <span class="s1">cache_subdir</span><span class="s2">=</span><span class="s3">&quot;models&quot;</span><span class="s2">,</span>
            <span class="s1">file_hash</span><span class="s2">=</span><span class="s1">file_hash</span><span class="s2">,</span>
        <span class="s2">)</span>
        <span class="s1">model</span><span class="s2">.</span><span class="s1">load_weights</span><span class="s2">(</span><span class="s1">weights_path</span><span class="s2">)</span>
    <span class="s0">elif </span><span class="s1">weights </span><span class="s0">is not None</span><span class="s2">:</span>
        <span class="s1">model</span><span class="s2">.</span><span class="s1">load_weights</span><span class="s2">(</span><span class="s1">weights</span><span class="s2">)</span>

    <span class="s0">return </span><span class="s1">model</span>


<span class="s2">@</span><span class="s1">keras_export</span><span class="s2">(</span>
    <span class="s2">[</span>
        <span class="s3">&quot;keras.applications.efficientnet_v2.EfficientNetV2B0&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;keras.applications.EfficientNetV2B0&quot;</span><span class="s2">,</span>
    <span class="s2">]</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">EfficientNetV2B0</span><span class="s2">(</span>
    <span class="s1">include_top</span><span class="s2">=</span><span class="s0">True</span><span class="s2">,</span>
    <span class="s1">weights</span><span class="s2">=</span><span class="s3">&quot;imagenet&quot;</span><span class="s2">,</span>
    <span class="s1">input_tensor</span><span class="s2">=</span><span class="s0">None</span><span class="s2">,</span>
    <span class="s1">input_shape</span><span class="s2">=</span><span class="s0">None</span><span class="s2">,</span>
    <span class="s1">pooling</span><span class="s2">=</span><span class="s0">None</span><span class="s2">,</span>
    <span class="s1">classes</span><span class="s2">=</span><span class="s5">1000</span><span class="s2">,</span>
    <span class="s1">classifier_activation</span><span class="s2">=</span><span class="s3">&quot;softmax&quot;</span><span class="s2">,</span>
    <span class="s1">include_preprocessing</span><span class="s2">=</span><span class="s0">True</span><span class="s2">,</span>
    <span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;efficientnetv2-b0&quot;</span><span class="s2">,</span>
<span class="s2">):</span>
    <span class="s0">return </span><span class="s1">EfficientNetV2</span><span class="s2">(</span>
        <span class="s1">width_coefficient</span><span class="s2">=</span><span class="s5">1.0</span><span class="s2">,</span>
        <span class="s1">depth_coefficient</span><span class="s2">=</span><span class="s5">1.0</span><span class="s2">,</span>
        <span class="s1">default_size</span><span class="s2">=</span><span class="s5">224</span><span class="s2">,</span>
        <span class="s1">name</span><span class="s2">=</span><span class="s1">name</span><span class="s2">,</span>
        <span class="s1">include_top</span><span class="s2">=</span><span class="s1">include_top</span><span class="s2">,</span>
        <span class="s1">weights</span><span class="s2">=</span><span class="s1">weights</span><span class="s2">,</span>
        <span class="s1">input_tensor</span><span class="s2">=</span><span class="s1">input_tensor</span><span class="s2">,</span>
        <span class="s1">input_shape</span><span class="s2">=</span><span class="s1">input_shape</span><span class="s2">,</span>
        <span class="s1">pooling</span><span class="s2">=</span><span class="s1">pooling</span><span class="s2">,</span>
        <span class="s1">classes</span><span class="s2">=</span><span class="s1">classes</span><span class="s2">,</span>
        <span class="s1">classifier_activation</span><span class="s2">=</span><span class="s1">classifier_activation</span><span class="s2">,</span>
        <span class="s1">include_preprocessing</span><span class="s2">=</span><span class="s1">include_preprocessing</span><span class="s2">,</span>
        <span class="s1">weights_name</span><span class="s2">=</span><span class="s3">&quot;b0&quot;</span><span class="s2">,</span>
    <span class="s2">)</span>


<span class="s2">@</span><span class="s1">keras_export</span><span class="s2">(</span>
    <span class="s2">[</span>
        <span class="s3">&quot;keras.applications.efficientnet_v2.EfficientNetV2B1&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;keras.applications.EfficientNetV2B1&quot;</span><span class="s2">,</span>
    <span class="s2">]</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">EfficientNetV2B1</span><span class="s2">(</span>
    <span class="s1">include_top</span><span class="s2">=</span><span class="s0">True</span><span class="s2">,</span>
    <span class="s1">weights</span><span class="s2">=</span><span class="s3">&quot;imagenet&quot;</span><span class="s2">,</span>
    <span class="s1">input_tensor</span><span class="s2">=</span><span class="s0">None</span><span class="s2">,</span>
    <span class="s1">input_shape</span><span class="s2">=</span><span class="s0">None</span><span class="s2">,</span>
    <span class="s1">pooling</span><span class="s2">=</span><span class="s0">None</span><span class="s2">,</span>
    <span class="s1">classes</span><span class="s2">=</span><span class="s5">1000</span><span class="s2">,</span>
    <span class="s1">classifier_activation</span><span class="s2">=</span><span class="s3">&quot;softmax&quot;</span><span class="s2">,</span>
    <span class="s1">include_preprocessing</span><span class="s2">=</span><span class="s0">True</span><span class="s2">,</span>
    <span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;efficientnetv2-b1&quot;</span><span class="s2">,</span>
<span class="s2">):</span>
    <span class="s0">return </span><span class="s1">EfficientNetV2</span><span class="s2">(</span>
        <span class="s1">width_coefficient</span><span class="s2">=</span><span class="s5">1.0</span><span class="s2">,</span>
        <span class="s1">depth_coefficient</span><span class="s2">=</span><span class="s5">1.1</span><span class="s2">,</span>
        <span class="s1">default_size</span><span class="s2">=</span><span class="s5">240</span><span class="s2">,</span>
        <span class="s1">name</span><span class="s2">=</span><span class="s1">name</span><span class="s2">,</span>
        <span class="s1">include_top</span><span class="s2">=</span><span class="s1">include_top</span><span class="s2">,</span>
        <span class="s1">weights</span><span class="s2">=</span><span class="s1">weights</span><span class="s2">,</span>
        <span class="s1">input_tensor</span><span class="s2">=</span><span class="s1">input_tensor</span><span class="s2">,</span>
        <span class="s1">input_shape</span><span class="s2">=</span><span class="s1">input_shape</span><span class="s2">,</span>
        <span class="s1">pooling</span><span class="s2">=</span><span class="s1">pooling</span><span class="s2">,</span>
        <span class="s1">classes</span><span class="s2">=</span><span class="s1">classes</span><span class="s2">,</span>
        <span class="s1">classifier_activation</span><span class="s2">=</span><span class="s1">classifier_activation</span><span class="s2">,</span>
        <span class="s1">include_preprocessing</span><span class="s2">=</span><span class="s1">include_preprocessing</span><span class="s2">,</span>
        <span class="s1">weights_name</span><span class="s2">=</span><span class="s3">&quot;b1&quot;</span><span class="s2">,</span>
    <span class="s2">)</span>


<span class="s2">@</span><span class="s1">keras_export</span><span class="s2">(</span>
    <span class="s2">[</span>
        <span class="s3">&quot;keras.applications.efficientnet_v2.EfficientNetV2B2&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;keras.applications.EfficientNetV2B2&quot;</span><span class="s2">,</span>
    <span class="s2">]</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">EfficientNetV2B2</span><span class="s2">(</span>
    <span class="s1">include_top</span><span class="s2">=</span><span class="s0">True</span><span class="s2">,</span>
    <span class="s1">weights</span><span class="s2">=</span><span class="s3">&quot;imagenet&quot;</span><span class="s2">,</span>
    <span class="s1">input_tensor</span><span class="s2">=</span><span class="s0">None</span><span class="s2">,</span>
    <span class="s1">input_shape</span><span class="s2">=</span><span class="s0">None</span><span class="s2">,</span>
    <span class="s1">pooling</span><span class="s2">=</span><span class="s0">None</span><span class="s2">,</span>
    <span class="s1">classes</span><span class="s2">=</span><span class="s5">1000</span><span class="s2">,</span>
    <span class="s1">classifier_activation</span><span class="s2">=</span><span class="s3">&quot;softmax&quot;</span><span class="s2">,</span>
    <span class="s1">include_preprocessing</span><span class="s2">=</span><span class="s0">True</span><span class="s2">,</span>
    <span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;efficientnetv2-b2&quot;</span><span class="s2">,</span>
<span class="s2">):</span>
    <span class="s0">return </span><span class="s1">EfficientNetV2</span><span class="s2">(</span>
        <span class="s1">width_coefficient</span><span class="s2">=</span><span class="s5">1.1</span><span class="s2">,</span>
        <span class="s1">depth_coefficient</span><span class="s2">=</span><span class="s5">1.2</span><span class="s2">,</span>
        <span class="s1">default_size</span><span class="s2">=</span><span class="s5">260</span><span class="s2">,</span>
        <span class="s1">name</span><span class="s2">=</span><span class="s1">name</span><span class="s2">,</span>
        <span class="s1">include_top</span><span class="s2">=</span><span class="s1">include_top</span><span class="s2">,</span>
        <span class="s1">weights</span><span class="s2">=</span><span class="s1">weights</span><span class="s2">,</span>
        <span class="s1">input_tensor</span><span class="s2">=</span><span class="s1">input_tensor</span><span class="s2">,</span>
        <span class="s1">input_shape</span><span class="s2">=</span><span class="s1">input_shape</span><span class="s2">,</span>
        <span class="s1">pooling</span><span class="s2">=</span><span class="s1">pooling</span><span class="s2">,</span>
        <span class="s1">classes</span><span class="s2">=</span><span class="s1">classes</span><span class="s2">,</span>
        <span class="s1">classifier_activation</span><span class="s2">=</span><span class="s1">classifier_activation</span><span class="s2">,</span>
        <span class="s1">include_preprocessing</span><span class="s2">=</span><span class="s1">include_preprocessing</span><span class="s2">,</span>
        <span class="s1">weights_name</span><span class="s2">=</span><span class="s3">&quot;b2&quot;</span><span class="s2">,</span>
    <span class="s2">)</span>


<span class="s2">@</span><span class="s1">keras_export</span><span class="s2">(</span>
    <span class="s2">[</span>
        <span class="s3">&quot;keras.applications.efficientnet_v2.EfficientNetV2B3&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;keras.applications.EfficientNetV2B3&quot;</span><span class="s2">,</span>
    <span class="s2">]</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">EfficientNetV2B3</span><span class="s2">(</span>
    <span class="s1">include_top</span><span class="s2">=</span><span class="s0">True</span><span class="s2">,</span>
    <span class="s1">weights</span><span class="s2">=</span><span class="s3">&quot;imagenet&quot;</span><span class="s2">,</span>
    <span class="s1">input_tensor</span><span class="s2">=</span><span class="s0">None</span><span class="s2">,</span>
    <span class="s1">input_shape</span><span class="s2">=</span><span class="s0">None</span><span class="s2">,</span>
    <span class="s1">pooling</span><span class="s2">=</span><span class="s0">None</span><span class="s2">,</span>
    <span class="s1">classes</span><span class="s2">=</span><span class="s5">1000</span><span class="s2">,</span>
    <span class="s1">classifier_activation</span><span class="s2">=</span><span class="s3">&quot;softmax&quot;</span><span class="s2">,</span>
    <span class="s1">include_preprocessing</span><span class="s2">=</span><span class="s0">True</span><span class="s2">,</span>
    <span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;efficientnetv2-b3&quot;</span><span class="s2">,</span>
<span class="s2">):</span>
    <span class="s0">return </span><span class="s1">EfficientNetV2</span><span class="s2">(</span>
        <span class="s1">width_coefficient</span><span class="s2">=</span><span class="s5">1.2</span><span class="s2">,</span>
        <span class="s1">depth_coefficient</span><span class="s2">=</span><span class="s5">1.4</span><span class="s2">,</span>
        <span class="s1">default_size</span><span class="s2">=</span><span class="s5">300</span><span class="s2">,</span>
        <span class="s1">name</span><span class="s2">=</span><span class="s1">name</span><span class="s2">,</span>
        <span class="s1">include_top</span><span class="s2">=</span><span class="s1">include_top</span><span class="s2">,</span>
        <span class="s1">weights</span><span class="s2">=</span><span class="s1">weights</span><span class="s2">,</span>
        <span class="s1">input_tensor</span><span class="s2">=</span><span class="s1">input_tensor</span><span class="s2">,</span>
        <span class="s1">input_shape</span><span class="s2">=</span><span class="s1">input_shape</span><span class="s2">,</span>
        <span class="s1">pooling</span><span class="s2">=</span><span class="s1">pooling</span><span class="s2">,</span>
        <span class="s1">classes</span><span class="s2">=</span><span class="s1">classes</span><span class="s2">,</span>
        <span class="s1">classifier_activation</span><span class="s2">=</span><span class="s1">classifier_activation</span><span class="s2">,</span>
        <span class="s1">include_preprocessing</span><span class="s2">=</span><span class="s1">include_preprocessing</span><span class="s2">,</span>
        <span class="s1">weights_name</span><span class="s2">=</span><span class="s3">&quot;b3&quot;</span><span class="s2">,</span>
    <span class="s2">)</span>


<span class="s2">@</span><span class="s1">keras_export</span><span class="s2">(</span>
    <span class="s2">[</span>
        <span class="s3">&quot;keras.applications.efficientnet_v2.EfficientNetV2S&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;keras.applications.EfficientNetV2S&quot;</span><span class="s2">,</span>
    <span class="s2">]</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">EfficientNetV2S</span><span class="s2">(</span>
    <span class="s1">include_top</span><span class="s2">=</span><span class="s0">True</span><span class="s2">,</span>
    <span class="s1">weights</span><span class="s2">=</span><span class="s3">&quot;imagenet&quot;</span><span class="s2">,</span>
    <span class="s1">input_tensor</span><span class="s2">=</span><span class="s0">None</span><span class="s2">,</span>
    <span class="s1">input_shape</span><span class="s2">=</span><span class="s0">None</span><span class="s2">,</span>
    <span class="s1">pooling</span><span class="s2">=</span><span class="s0">None</span><span class="s2">,</span>
    <span class="s1">classes</span><span class="s2">=</span><span class="s5">1000</span><span class="s2">,</span>
    <span class="s1">classifier_activation</span><span class="s2">=</span><span class="s3">&quot;softmax&quot;</span><span class="s2">,</span>
    <span class="s1">include_preprocessing</span><span class="s2">=</span><span class="s0">True</span><span class="s2">,</span>
    <span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;efficientnetv2-s&quot;</span><span class="s2">,</span>
<span class="s2">):</span>
    <span class="s0">return </span><span class="s1">EfficientNetV2</span><span class="s2">(</span>
        <span class="s1">width_coefficient</span><span class="s2">=</span><span class="s5">1.0</span><span class="s2">,</span>
        <span class="s1">depth_coefficient</span><span class="s2">=</span><span class="s5">1.0</span><span class="s2">,</span>
        <span class="s1">default_size</span><span class="s2">=</span><span class="s5">384</span><span class="s2">,</span>
        <span class="s1">name</span><span class="s2">=</span><span class="s1">name</span><span class="s2">,</span>
        <span class="s1">include_top</span><span class="s2">=</span><span class="s1">include_top</span><span class="s2">,</span>
        <span class="s1">weights</span><span class="s2">=</span><span class="s1">weights</span><span class="s2">,</span>
        <span class="s1">input_tensor</span><span class="s2">=</span><span class="s1">input_tensor</span><span class="s2">,</span>
        <span class="s1">input_shape</span><span class="s2">=</span><span class="s1">input_shape</span><span class="s2">,</span>
        <span class="s1">pooling</span><span class="s2">=</span><span class="s1">pooling</span><span class="s2">,</span>
        <span class="s1">classes</span><span class="s2">=</span><span class="s1">classes</span><span class="s2">,</span>
        <span class="s1">classifier_activation</span><span class="s2">=</span><span class="s1">classifier_activation</span><span class="s2">,</span>
        <span class="s1">include_preprocessing</span><span class="s2">=</span><span class="s1">include_preprocessing</span><span class="s2">,</span>
        <span class="s1">weights_name</span><span class="s2">=</span><span class="s3">&quot;-s&quot;</span><span class="s2">,</span>
    <span class="s2">)</span>


<span class="s2">@</span><span class="s1">keras_export</span><span class="s2">(</span>
    <span class="s2">[</span>
        <span class="s3">&quot;keras.applications.efficientnet_v2.EfficientNetV2M&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;keras.applications.EfficientNetV2M&quot;</span><span class="s2">,</span>
    <span class="s2">]</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">EfficientNetV2M</span><span class="s2">(</span>
    <span class="s1">include_top</span><span class="s2">=</span><span class="s0">True</span><span class="s2">,</span>
    <span class="s1">weights</span><span class="s2">=</span><span class="s3">&quot;imagenet&quot;</span><span class="s2">,</span>
    <span class="s1">input_tensor</span><span class="s2">=</span><span class="s0">None</span><span class="s2">,</span>
    <span class="s1">input_shape</span><span class="s2">=</span><span class="s0">None</span><span class="s2">,</span>
    <span class="s1">pooling</span><span class="s2">=</span><span class="s0">None</span><span class="s2">,</span>
    <span class="s1">classes</span><span class="s2">=</span><span class="s5">1000</span><span class="s2">,</span>
    <span class="s1">classifier_activation</span><span class="s2">=</span><span class="s3">&quot;softmax&quot;</span><span class="s2">,</span>
    <span class="s1">include_preprocessing</span><span class="s2">=</span><span class="s0">True</span><span class="s2">,</span>
    <span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;efficientnetv2-m&quot;</span><span class="s2">,</span>
<span class="s2">):</span>
    <span class="s0">return </span><span class="s1">EfficientNetV2</span><span class="s2">(</span>
        <span class="s1">width_coefficient</span><span class="s2">=</span><span class="s5">1.0</span><span class="s2">,</span>
        <span class="s1">depth_coefficient</span><span class="s2">=</span><span class="s5">1.0</span><span class="s2">,</span>
        <span class="s1">default_size</span><span class="s2">=</span><span class="s5">480</span><span class="s2">,</span>
        <span class="s1">name</span><span class="s2">=</span><span class="s1">name</span><span class="s2">,</span>
        <span class="s1">include_top</span><span class="s2">=</span><span class="s1">include_top</span><span class="s2">,</span>
        <span class="s1">weights</span><span class="s2">=</span><span class="s1">weights</span><span class="s2">,</span>
        <span class="s1">input_tensor</span><span class="s2">=</span><span class="s1">input_tensor</span><span class="s2">,</span>
        <span class="s1">input_shape</span><span class="s2">=</span><span class="s1">input_shape</span><span class="s2">,</span>
        <span class="s1">pooling</span><span class="s2">=</span><span class="s1">pooling</span><span class="s2">,</span>
        <span class="s1">classes</span><span class="s2">=</span><span class="s1">classes</span><span class="s2">,</span>
        <span class="s1">classifier_activation</span><span class="s2">=</span><span class="s1">classifier_activation</span><span class="s2">,</span>
        <span class="s1">include_preprocessing</span><span class="s2">=</span><span class="s1">include_preprocessing</span><span class="s2">,</span>
        <span class="s1">weights_name</span><span class="s2">=</span><span class="s3">&quot;-m&quot;</span><span class="s2">,</span>
    <span class="s2">)</span>


<span class="s2">@</span><span class="s1">keras_export</span><span class="s2">(</span>
    <span class="s2">[</span>
        <span class="s3">&quot;keras.applications.efficientnet_v2.EfficientNetV2L&quot;</span><span class="s2">,</span>
        <span class="s3">&quot;keras.applications.EfficientNetV2L&quot;</span><span class="s2">,</span>
    <span class="s2">]</span>
<span class="s2">)</span>
<span class="s0">def </span><span class="s1">EfficientNetV2L</span><span class="s2">(</span>
    <span class="s1">include_top</span><span class="s2">=</span><span class="s0">True</span><span class="s2">,</span>
    <span class="s1">weights</span><span class="s2">=</span><span class="s3">&quot;imagenet&quot;</span><span class="s2">,</span>
    <span class="s1">input_tensor</span><span class="s2">=</span><span class="s0">None</span><span class="s2">,</span>
    <span class="s1">input_shape</span><span class="s2">=</span><span class="s0">None</span><span class="s2">,</span>
    <span class="s1">pooling</span><span class="s2">=</span><span class="s0">None</span><span class="s2">,</span>
    <span class="s1">classes</span><span class="s2">=</span><span class="s5">1000</span><span class="s2">,</span>
    <span class="s1">classifier_activation</span><span class="s2">=</span><span class="s3">&quot;softmax&quot;</span><span class="s2">,</span>
    <span class="s1">include_preprocessing</span><span class="s2">=</span><span class="s0">True</span><span class="s2">,</span>
    <span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;efficientnetv2-l&quot;</span><span class="s2">,</span>
<span class="s2">):</span>
    <span class="s0">return </span><span class="s1">EfficientNetV2</span><span class="s2">(</span>
        <span class="s1">width_coefficient</span><span class="s2">=</span><span class="s5">1.0</span><span class="s2">,</span>
        <span class="s1">depth_coefficient</span><span class="s2">=</span><span class="s5">1.0</span><span class="s2">,</span>
        <span class="s1">default_size</span><span class="s2">=</span><span class="s5">480</span><span class="s2">,</span>
        <span class="s1">name</span><span class="s2">=</span><span class="s1">name</span><span class="s2">,</span>
        <span class="s1">include_top</span><span class="s2">=</span><span class="s1">include_top</span><span class="s2">,</span>
        <span class="s1">weights</span><span class="s2">=</span><span class="s1">weights</span><span class="s2">,</span>
        <span class="s1">input_tensor</span><span class="s2">=</span><span class="s1">input_tensor</span><span class="s2">,</span>
        <span class="s1">input_shape</span><span class="s2">=</span><span class="s1">input_shape</span><span class="s2">,</span>
        <span class="s1">pooling</span><span class="s2">=</span><span class="s1">pooling</span><span class="s2">,</span>
        <span class="s1">classes</span><span class="s2">=</span><span class="s1">classes</span><span class="s2">,</span>
        <span class="s1">classifier_activation</span><span class="s2">=</span><span class="s1">classifier_activation</span><span class="s2">,</span>
        <span class="s1">include_preprocessing</span><span class="s2">=</span><span class="s1">include_preprocessing</span><span class="s2">,</span>
        <span class="s1">weights_name</span><span class="s2">=</span><span class="s3">&quot;-l&quot;</span><span class="s2">,</span>
    <span class="s2">)</span>


<span class="s1">EfficientNetV2B0</span><span class="s2">.</span><span class="s1">__doc__ </span><span class="s2">= </span><span class="s1">BASE_DOCSTRING</span><span class="s2">.</span><span class="s1">format</span><span class="s2">(</span><span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;EfficientNetV2B0&quot;</span><span class="s2">)</span>
<span class="s1">EfficientNetV2B1</span><span class="s2">.</span><span class="s1">__doc__ </span><span class="s2">= </span><span class="s1">BASE_DOCSTRING</span><span class="s2">.</span><span class="s1">format</span><span class="s2">(</span><span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;EfficientNetV2B1&quot;</span><span class="s2">)</span>
<span class="s1">EfficientNetV2B2</span><span class="s2">.</span><span class="s1">__doc__ </span><span class="s2">= </span><span class="s1">BASE_DOCSTRING</span><span class="s2">.</span><span class="s1">format</span><span class="s2">(</span><span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;EfficientNetV2B2&quot;</span><span class="s2">)</span>
<span class="s1">EfficientNetV2B3</span><span class="s2">.</span><span class="s1">__doc__ </span><span class="s2">= </span><span class="s1">BASE_DOCSTRING</span><span class="s2">.</span><span class="s1">format</span><span class="s2">(</span><span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;EfficientNetV2B3&quot;</span><span class="s2">)</span>
<span class="s1">EfficientNetV2S</span><span class="s2">.</span><span class="s1">__doc__ </span><span class="s2">= </span><span class="s1">BASE_DOCSTRING</span><span class="s2">.</span><span class="s1">format</span><span class="s2">(</span><span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;EfficientNetV2S&quot;</span><span class="s2">)</span>
<span class="s1">EfficientNetV2M</span><span class="s2">.</span><span class="s1">__doc__ </span><span class="s2">= </span><span class="s1">BASE_DOCSTRING</span><span class="s2">.</span><span class="s1">format</span><span class="s2">(</span><span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;EfficientNetV2M&quot;</span><span class="s2">)</span>
<span class="s1">EfficientNetV2L</span><span class="s2">.</span><span class="s1">__doc__ </span><span class="s2">= </span><span class="s1">BASE_DOCSTRING</span><span class="s2">.</span><span class="s1">format</span><span class="s2">(</span><span class="s1">name</span><span class="s2">=</span><span class="s3">&quot;EfficientNetV2L&quot;</span><span class="s2">)</span>


<span class="s2">@</span><span class="s1">keras_export</span><span class="s2">(</span><span class="s3">&quot;keras.applications.efficientnet_v2.preprocess_input&quot;</span><span class="s2">)</span>
<span class="s0">def </span><span class="s1">preprocess_input</span><span class="s2">(</span><span class="s1">x</span><span class="s2">, </span><span class="s1">data_format</span><span class="s2">=</span><span class="s0">None</span><span class="s2">):</span>
    <span class="s6">&quot;&quot;&quot;A placeholder method for backward compatibility. 
 
    The preprocessing logic has been included in the EfficientNetV2 model 
    implementation. Users are no longer required to call this method to 
    normalize the input data. This method does nothing and only kept as a 
    placeholder to align the API surface between old and new version of model. 
 
    Args: 
        x: A floating point `numpy.array` or a tensor. 
        data_format: Optional data format of the image tensor/array. Defaults to 
            None, in which case the global setting 
            `keras.backend.image_data_format()` is used 
            (unless you changed it, it defaults to &quot;channels_last&quot;).{mode} 
 
    Returns: 
        Unchanged `numpy.array` or tensor. 
    &quot;&quot;&quot;</span>
    <span class="s0">return </span><span class="s1">x</span>


<span class="s2">@</span><span class="s1">keras_export</span><span class="s2">(</span><span class="s3">&quot;keras.applications.efficientnet_v2.decode_predictions&quot;</span><span class="s2">)</span>
<span class="s0">def </span><span class="s1">decode_predictions</span><span class="s2">(</span><span class="s1">preds</span><span class="s2">, </span><span class="s1">top</span><span class="s2">=</span><span class="s5">5</span><span class="s2">):</span>
    <span class="s0">return </span><span class="s1">imagenet_utils</span><span class="s2">.</span><span class="s1">decode_predictions</span><span class="s2">(</span><span class="s1">preds</span><span class="s2">, </span><span class="s1">top</span><span class="s2">=</span><span class="s1">top</span><span class="s2">)</span>


<span class="s1">decode_predictions</span><span class="s2">.</span><span class="s1">__doc__ </span><span class="s2">= </span><span class="s1">imagenet_utils</span><span class="s2">.</span><span class="s1">decode_predictions</span><span class="s2">.</span><span class="s1">__doc__</span>
</pre>
</body>
</html>